Backbone.Memento=function(a,b){"use strict";var c=function(a,c){this.version="0.4.2",c=b.extend({ignore:[]},c);var d=new e(a,c),g=new f(a,c),h=function(a,b){a&&d.deserialize(a,b)};this.store=function(){var a=d.serialize();g.push(a)},this.restore=function(a){var b=g.pop();h(b,a)},this.restart=function(a){var b=g.rewind();h(b,a)},this.consolidate=function(){g=new f(a,c),this.store()}},d=function(b){b instanceof a.Model?(this.removeAttr=function(a){b.unset(a)},this.restore=function(a){b.set(a)}):(this.removeAttr=function(a){b.remove(a)},this.restore=function(a){b.reset(a)})},e=function(a,c){function e(a,c){if(a=b.clone(a),c.hasOwnProperty("ignore")&&c.ignore.length>0)for(var d in c.ignore){var e=c.ignore[d];delete a[e]}return a}function f(a,b){var c=[];if(!a||!b)return c;for(var d in b)b.hasOwnProperty(d)&&(a.hasOwnProperty(d)||c.push(d));return c}function g(a,b){for(var c in b){var d=b[c];i.removeAttr(d)}}function h(b,c){var d=e(b,c),h=a.toJSON();h=e(h,c);var j=f(d,h);g(a,j),i.restore(d)}var i=new d(a);this.serialize=function(){var b=a.toJSON();return b=e(b,c)},this.deserialize=function(a,d){d=b.extend({},c,d),h(a,d)}},f=function(){function a(){b=[]}var b;this.push=function(a){b.push(a)},this.pop=function(){var a=b.pop();return a},this.rewind=function(){var c=b[0];return a(),c},a()};return c}(Backbone,_);